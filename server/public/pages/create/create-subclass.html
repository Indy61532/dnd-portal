<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HeroVault - D&D Character Manager</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/create-subclass.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bahiana&family=Cinzel:wght@400;600;700&family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="content">
        <div class="navbar main-header">
            <div class="nav-content">
                <a href="/index.html">
                    <div class="nav-left">
                        <i class="fas logo fa-dragon "></i>
                        <span class="brand">HeroVault</span>
                    </div>
                </a>
                <div class="nav-center create-navbar">
                    <div class="cteate-title">Creating subclass</div>
                </div>
                <div class="nav-right profile">
                    <div class="profileimg"></div>
                    <div class="profilename">Adventure Master</div>
                </div>
            </div>
        </div>

        <div class="main">

            <div class="section-subclass-info">
                <div class="section-title">Subclass Info</div>

                <div class="text-input full-width">
                    <div>Subclass name</div>
                    <input type="text" id="subclass-name" name="subclass-name" list="list-id-name" placeholder="Enter subclass name...">
                </div>

                <div class="description">
                    <div>Subclass Description</div>
                    <textarea name="subclass-description" id="subclass-description" ></textarea>
                </div>
                
            </div>

            <div class="section-subclass-description">
                <div class="section-title">Subclass Description</div>

                <!-- Common table-1 for all subclass types -->
                <div class="table-1">
                    <div class="row-1"><div>Level</div> <div>Features</div></div>
                    <div class="row-2 level-1"> <div>1st</div>  <div class="multiselect-container"><input type="text" list="list-non-caster" placeholder="Select features..." class="multiselect-input" onkeydown="return false;"><div class="selected-tags"></div></div></div>
                    <div class="row-3 level-2"> <div>2nd</div>  <div class="multiselect-container"><input type="text" list="list-non-caster" placeholder="Select features..." class="multiselect-input" onkeydown="return false;"><div class="selected-tags"></div></div></div>
                    <div class="row-4 level-3"> <div>3rd</div>  <div class="multiselect-container"><input type="text" list="list-non-caster" placeholder="Select features..." class="multiselect-input" onkeydown="return false;"><div class="selected-tags"></div></div></div>
                    <div class="row-5 level-4"> <div>4th</div>  <div class="multiselect-container"><input type="text" list="list-non-caster" placeholder="Select features..." class="multiselect-input" onkeydown="return false;"><div class="selected-tags"></div></div></div>
                    <div class="row-6 level-5"> <div>5th</div>   <div class="multiselect-container"><input type="text" list="list-non-caster" placeholder="Select features..." class="multiselect-input" onkeydown="return false;"><div class="selected-tags"></div></div></div>
                    <div class="row-7 level-6"> <div>6th</div>   <div class="multiselect-container"><input type="text" list="list-non-caster" placeholder="Select features..." class="multiselect-input" onkeydown="return false;"><div class="selected-tags"></div></div></div>
                    <div class="row-8 level-7"> <div>7th</div>   <div class="multiselect-container"><input type="text" list="list-non-caster" placeholder="Select features..." class="multiselect-input" onkeydown="return false;"><div class="selected-tags"></div></div></div>
                    <div class="row-9 level-8"> <div>8th</div>   <div class="multiselect-container"><input type="text" list="list-non-caster" placeholder="Select features..." class="multiselect-input" onkeydown="return false;"><div class="selected-tags"></div></div></div>
                    <div class="row-10 level-9"> <div>9th</div>   <div class="multiselect-container"><input type="text" list="list-non-caster" placeholder="Select features..." class="multiselect-input" onkeydown="return false;"><div class="selected-tags"></div></div></div>
                    <div class="row-11 level-10"> <div>10th</div>   <div class="multiselect-container"><input type="text" list="list-non-caster" placeholder="Select features..." class="multiselect-input" onkeydown="return false;"><div class="selected-tags"></div></div></div>
                    <div class="row-12 level-11"> <div>11th</div>   <div class="multiselect-container"><input type="text" list="list-non-caster" placeholder="Select features..." class="multiselect-input" onkeydown="return false;"><div class="selected-tags"></div></div></div>
                    <div class="row-13 level-12"> <div>12th</div>   <div class="multiselect-container"><input type="text" list="list-non-caster" placeholder="Select features..." class="multiselect-input" onkeydown="return false;"><div class="selected-tags"></div></div></div>
                    <div class="row-14 level-13"> <div>13th</div>   <div class="multiselect-container"><input type="text" list="list-non-caster" placeholder="Select features..." class="multiselect-input" onkeydown="return false;"><div class="selected-tags"></div></div></div>
                    <div class="row-15 level-14"> <div>14th</div>   <div class="multiselect-container"><input type="text" list="list-non-caster" placeholder="Select features..." class="multiselect-input" onkeydown="return false;"><div class="selected-tags"></div></div></div>
                    <div class="row-16 level-15"> <div>15th</div>   <div class="multiselect-container"><input type="text" list="list-non-caster" placeholder="Select features..." class="multiselect-input" onkeydown="return false;"><div class="selected-tags"></div></div></div>
                    <div class="row-17 level-16"> <div>16th</div>   <div class="multiselect-container"><input type="text" list="list-non-caster" placeholder="Select features..." class="multiselect-input" onkeydown="return false;"><div class="selected-tags"></div></div></div>
                    <div class="row-18 level-17"> <div>17th</div>   <div class="multiselect-container"><input type="text" list="list-non-caster" placeholder="Select features..." class="multiselect-input" onkeydown="return false;"><div class="selected-tags"></div></div></div>
                    <div class="row-19 level-18"> <div>18th</div>   <div class="multiselect-container"><input type="text" list="list-non-caster" placeholder="Select features..." class="multiselect-input" onkeydown="return false;"><div class="selected-tags"></div></div></div>
                    <div class="row-20 level-19"> <div>19th</div>   <div class="multiselect-container"><input type="text" list="list-non-caster" placeholder="Select features..." class="multiselect-input" onkeydown="return false;"><div class="selected-tags"></div></div></div>
                    <div class="row-21 level-20"> <div>20th</div>   <div class="multiselect-container"><input type="text" list="list-non-caster" placeholder="Select features..." class="multiselect-input" onkeydown="return false;"><div class="selected-tags"></div></div></div>
                </div>
                
            </div>

            <div class="section-class-features">
                <div class="section-title">Sub-class Features</div>
                
                <div class="feature-builder">
                    <div class="feature-inputs">
                        <div class="text-input">
                            <div>Feature Name</div>
                            <input type="text" id="new-feature-name" placeholder="e.g. Divine Smite">
                        </div>
                        <div class="text-input">
                            <div>Feature Description</div>
                            <textarea id="new-feature-description" placeholder="Describe the capability..." rows="3"></textarea>
                        </div>
                        <button id="add-feature-btn" class="button-create small-btn">Add Feature</button>
                    </div>
                    
                    <div class="features-list" id="features-list">
                        <!-- Added features will appear here -->
                        <div class="empty-state">No custom features added yet. Create one above to assign it to levels.</div>
                    </div>
                </div>
            </div>

            <div class="section-otional">
                <div class="section-title">Optional</div>
                                

            </div>
            <div class="input-img">
                <button class="button-create">Create</button>
            </div>
        </div>
    </div>

    <script src="/js/runtime-config.js"></script>
    <script type="module" src="/js/supabase-client.js"></script>
    <script type="module" src="/js/auth-ui.js"></script>
    <!-- Centralized datalists are loaded automatically by datalists-loader.js -->
<script src="/js/datalists-loader.js"></script>

<script src="/js/multiselect.js"></script>
<script src="https://cdn.jsdelivr.net/npm/tinymce@6/tinymce.min.js"></script>
<script src="/js/tinymce-config.js"></script>
<script>
// TinyMCE initialization is now handled by tinymce-config.js

// Feature Builder Logic (similar to create-class)
document.addEventListener('DOMContentLoaded', function() {
    const addFeatureBtn = document.getElementById('add-feature-btn');
    const featureNameInput = document.getElementById('new-feature-name');
    const featureDescInput = document.getElementById('new-feature-description');
    const featuresList = document.getElementById('features-list');
    
    // Toast notification function
    function showToast(message, type = 'success') {
        const toast = document.createElement('div');
        toast.textContent = message;
        toast.style.position = 'fixed';
        toast.style.bottom = '20px';
        toast.style.right = '20px';
        toast.style.backgroundColor = type === 'success' ? '#10B981' : '#EF4444';
        toast.style.color = 'white';
        toast.style.padding = '1rem 2rem';
        toast.style.borderRadius = '8px';
        toast.style.zIndex = '1000';
        toast.style.boxShadow = '0 4px 6px rgba(0,0,0,0.1)';
        toast.style.opacity = '0';
        toast.style.transition = 'opacity 0.3s ease';
        
        document.body.appendChild(toast);
        
        // Trigger reflow
        void toast.offsetWidth;
        toast.style.opacity = '1';
        
        setTimeout(() => {
            toast.style.opacity = '0';
            setTimeout(() => toast.remove(), 300);
        }, 3000);
    }

    if (addFeatureBtn) {
        addFeatureBtn.addEventListener('click', function() {
            const name = featureNameInput.value.trim();
            const desc = featureDescInput.value.trim();
            
            if (!name) {
                showToast('Please enter a feature name', 'error');
                return;
            }
            
            // Add to datalist if it exists
            const datalist = document.getElementById('list-non-caster');
            if (datalist) {
                // Check if already exists
                let exists = false;
                for (let option of datalist.options) {
                    if (option.value === name) {
                        exists = true;
                        break;
                    }
                }
                
                if (!exists) {
                    const option = document.createElement('option');
                    option.value = name;
                    datalist.appendChild(option);
                }
            }
            
            // Create visual card
            const card = document.createElement('div');
            card.className = 'feature-card';
            card.innerHTML = `
                <h4>${name}</h4>
                <p>${desc}</p>
                <button class="feature-delete" title="Remove feature"><i class="fas fa-times"></i></button>
            `;
            
            // Remove empty state if present
            const emptyState = featuresList.querySelector('.empty-state');
            if (emptyState) {
                emptyState.remove();
            }
            
            featuresList.appendChild(card);
            
            // Handle delete
            card.querySelector('.feature-delete').addEventListener('click', function() {
                card.remove();
                if (featuresList.children.length === 0) {
                    featuresList.innerHTML = '<div class="empty-state">No custom features added yet. Create one above to assign it to levels.</div>';
                }
            });
            
            // Clear inputs
            featureNameInput.value = '';
            featureDescInput.value = '';
            showToast('Feature added successfully');
        });
    }
});
</script>
<script src="/js/create-subclass-save.js"></script>
</body>
</html>